<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Jekyll v4.0.0" /><meta property="og:title" content="Search" /><meta name="author" content="Clarence M." /><meta property="og:locale" content="en_US" /><meta name="description" content="This blog is a place to share my knowledge and experience within the world of IT." /><meta property="og:description" content="This blog is a place to share my knowledge and experience within the world of IT." /><link rel="canonical" href="https://cm0.dev/search/" /><meta property="og:url" content="https://cm0.dev/search/" /><meta property="og:site_name" content="Clarence M." /> <script type="application/ld+json"> {"url":"https://cm0.dev/search/","author":{"@type":"Person","name":"Clarence M."},"description":"This blog is a place to share my knowledge and experience within the world of IT.","headline":"Search","@type":"WebPage","@context":"https://schema.org"}</script><title> Search - Clarence M.</title><link rel="shortcut icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" title="Clarence M." href="/atom.xml"><link rel="alternate" type="application/json" title="Clarence M." href="https://cm0.dev/feed.json" /><link rel="sitemap" type="application/xml" title="sitemap" href="/sitemap.xml" /><link rel="stylesheet" href="/assets/css/styles.css"><link rel="preconnect" href="//fonts.gstatic.com"><link href="//fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-FRJ10EYV1N"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-FRJ10EYV1N'); </script></head><body><main role="main"><section id="intro"><div class="flex-row-between"><h1> Search</h1><button id="theme-toggle" onclick="modeSwitcher()"><div></div></button></div><a href="https://cm0.dev/">« back</a><div class="search-article"> <label for="search-input" aria-hidden="true"> <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="rgba(128,128,128,0.8)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </label> <form action="/search" method="get"> <input type="search" name="query" id="search-input" placeholder="Search for posts here" aria-label="Search"> <input type="submit" value="search" hidden /> </form></div></section><ul id="search-results"></ul><script> window.store = { "2022-01-06-avaya-1100-series-freepbx": { "title": "Using Avaya 1100 Series IP phones with FreePBX", "author": "", "category": "", "content": "I had a few Avaya/Nortel 1120e/1140e IP phones laying around at home and decided to create a house phone and intercom system. Setting these phones up with FreePBX/Astericks was a chore and after many hours of trial and error and google searching, i’ve managed to get these working pretty well with FreePBX.Prerequisites Advanced technical knowledge. This guide is not intended for beginners. A working FreePBX/Asterisks server. A TFTP server. (Optional) A configurable DHCP server.Converting Phones from UNISTIM to SIPIf you have one of these phones, there is a good chance that it is running the old UNISTIM firmware. You will need to flash the SIP firmware to the phone in order to get it to work with FreePBX.In order to do this easily, a TFTP server should be used. TFTPD64 is an example of one to use. Then configure your DHCP server to include the TFTP’s server IP address in DHCP option 66. If your DHCP server does not allow you to do this, then use TFTPD64’s built in DHCP server.Next download the latest firmware for your phone’s model. The latest versions are always available on Avaya’s website. Place the downloaded .bin file in the TFTP server’s root directory.In the TFTP’s root directory, you will then need to create the following files depending on your phone model. 1120e.cfg 1120eSIP.cfg 1140e.cfg 1140eSIP.cfgIt is important that they are named according to your phone’s model as shown as above. The phone will be looking for these files as soon as it connects to the TFTP server.In each .cfg file above, include the following contents at the top:[FW]DOWNLOAD_MODE FORCEDVERSION &lt;firmware file name&gt;FILENAME &lt;firmware file name&gt;PROTOCOL TFTPSERVER_IP &lt;tftp server ip&gt;SECURITY_MODE 0 Replace &lt;firmware file name&gt; with the file name of the firmware you downloaded from Avaya. Ensure that the firmware file is correct for the model you are upgrading. Replace &lt;tftp server ip&gt; with the IP address of your TFTP server.Now power up the phone whilst connected to the network and the phone should begin to upgrade its firmware. When the phone powers up, it will obtain the TFTP server automatically from the DHCP server. Then the following will happen: Read the appropriate firmware file for the phone’s model. For example, a 1120e on the UNISTIM firmware will read the 1120e.cfg file or a 1120e on the SIP firmware will read the 1120eSIP.cfg file. The phone then downloads the firmware file specified in the configuration file. The phone will write the firmware to its memory and reboot. If the phone was previously on the UNISTIM firmware and now on the SIP firmware, it will now read configuration files ending in SIP.Error: Authentication FailedIf you receive an error [FW] Authentication Failed this usually means that you are upgrading the firmware of the phone that is too far ahead. In this case you will need to incrementally upgrade the phone up until the latest the version.You may also try using the phone’s BootC mode which is essentialy its recovery mode. I’ve found that you can usually bypass this error using this mode. When the phone immediately powers on, hold the Up + 2 key until you see Starting DHCP... and it will contact the TFTP server to grab the firmware files.If in BootC mode, the phone continues to boot normally after Starting DHCP... is shown, you will need to manually input the TFTP server. Again hold Up + 2 but as soon as the phone’s lights turn off, immediately press the four soft keys below the screen, from left to right in quick succession. If done correctly, you should see a manual configuration prompt. This mode will allow you to input your TFTP’s server IP address. Use the phone’s buttons to navigate through this menu. After you have applied the settings, the phone should reboot and upgrade the firmware.Setting up FreePBX/AsteriskOnce you have upgraded the firmware to SIP, you can now configure FreePBX. In the FreePBX GUI, create a CHAN_SIP extension. It is important that it is on CHAN_SIP as using CHAN_PJSIP will cause the phones to loose SIP registration to the PBX after some time. Take note that when using CHAN_SIP extensions, the SIP port will be 5160/udp instead of the standard 5060/udp port.Creating Provisoning FilesWe will now create provisoning files for the phones so that they can connect to the FreePBX server. This can also be done manually by inputting the SIP domain and authentication credentials manually on the phone itself.Using the same TFTP server, open your device’s model configuration file. So if you have a 1120e phone, open the 1120eSIP.cfg file. Below the [FW] section, add the following section below it:[DEVICE_CONFIG]DOWNLOAD_MODE FORCEDFILENAME device.cfgVERSION 000001PROTOCOL TFTP[USER_CONFIG]DOWNLOAD_MODE FORCEDVERSION 000001PROTOCOL TFTPEnsure that [DEVICE_CONFIG] is followed by [USER_CONFIG] as the phone reads these files from top to bottom and will overwrite settings if the sections are out of order.Next create a device.cfg file in the same directory on the TFTP server. In that file, put the following contents:DNS_DOMAIN &lt;dns domain&gt;SIP_DOMAIN1 &lt;sip domain&gt;SERVER_IP1_1 &lt;sip domain&gt;SERVER_PORT1_1 5160SERVER_RETRIES1 3FORCE_BANNER YESBANNER THIS IS A BANNERVMAIL *97VMAIL_DELAY 300MAX_APPEARANCE 1DEF_LANG EnglishDEF_AUDIO_QUALITY HighLLDP_ENABLE YESADMIN_PASSWORD 1234ADMIN_PASSWORD_EXPIRY 0DEF_AUDIO_QUALITY HighTIMEZONE_OFFSET &lt;time zone&gt;FORCE_TIME_ZONE YES# Disable extended featuresMAX_LOGINS 1USB_HEADSET LOCKEXP_MODULE_ENABLE NOENABLE_SERVICE_PACKAGE NOIM_MODE DISABLEDAVAYA_AUTOMATIC_QoS NOVQMON_PUBLISH NOSIP_TLS_PORT 0ENABLE_BT NOReplace… &lt;dns domain&gt; with the DNS domain name of your PBX. This can also be set to the IP address of the PBX server. &lt;sip domain&gt; with the SIP domain name of your PBX. This can also be set to the IP address of the PBX server. &lt;time zone&gt; with the time zone offset. The offsets are: Location Time zone offset (seconds) (GMT-04:00) Atlantic Standard Time -14400 (GMT-03:30) Newfoundland -12600 (GMT-03:00) Buenos Aires -10800 (GMT-02:30) Newfoundland DST -9000 (GMT-01:00) Azores -3600 (GMT+00:00) Greenwich, Dublin, Lisbon, London 0 (GMT+01:00) Central European Time 3600 (GMT+02:00) Athens 7200 (GMT+03:00) Moscow 10800 (GMT+03:30) Tehran 12600 (GMT+04:00) Abu Dhabi 14400 (GMT+04:30) Khabul 16200 (GMT+05:00) Islamabad 18000 (GMT+05:30) Indian Standard Time 19800 (GMT+06:00) Sri Lanka 21600 (GMT+06:30) Myanmar 23400 (GMT+07:00) Bangkok 25200 (GMT+08:00) China Standard Time 28800 (GMT+09:00) Japan Standard Time 32400 (GMT+09:30) Australian Central Standard Time 34200 (GMT+10:00) Australian Eastern Standard Time 36000 (GMT+11:00) Micronesia 39600 (GMT+12:00) Fiji 43200 (GMT+13:00) New Zealand 46800 If you do not have a license for these phones, ensure that everything below Disable extended features is included, otherwise you will not be able to login to the phone.Now you will need to get the MAC address of the phone. This can be found at the back of the phone. Once you have the MAC address, create a file called SIP&lt;MAC&gt;.cfg replacing &lt;MAC&gt; with the phone’s MAC address. In that file, put the following contents:AUTOLOGIN_ENABLE USE_AUTOLOGIN_IDAUTOLOGIN_ID_KEY01 &lt;sip username&gt;@&lt;sip domain&gt;AUTOLOGIN_AUTHID_KEY01 &lt;sip username&gt;AUTOLOGIN_PASSWD_KEY01 &lt;sip password&gt;Replace… &lt;sip username&gt; with the SIP username of your desired extension. &lt;sip domain&gt; with the SIP domain name of your PBX that you configured in device.cfg &lt;sip password&gt; with the SIP password of your desired extension.Once you are done, reboot the phone and it should grab the configuration files from the TFTP server and connect to your FreePBX server.Configuring other Phone Features.There are a lot of paramters that can be configured. Refer to the SIP Administration Guide from Avaya for more information.Configuring Intercom/Paging FeaturesTo get intercom/paging working on FreePBX, you will need to set ENABLE_ANSWER_MODE to YES in the device.cfg file. Unfortunately, enabling this will require a license for the phone. If you do not have a license and you enable this, you will be locked out of the phone until it is disabled and reset. After you have enabled this, go into the phone’s preferences (press more soft key until you see prefs) -&gt; Feature Options -&gt; Answer Mode Settings and set Allow Mode to public and in Allow Addresses input the SIP addresses to allow intercom/paging from.Then on FreePBX ssh into it and edit /etc/asterisk/extensions_override_freepbx.conf with the following:[autoanswer]include =&gt; autoanswer-customexten =&gt; s,1,GosubIf($[\"${ARG1}\" != \"\"]?func-set-sipheader,s,1(Alert-Info,${ARG1}))exten =&gt; s,n,GosubIf($[\"${ARG2}\" != \"\"]?func-set-sipheader,s,1(Call-Info,${ARG2}))exten =&gt; s,n,Gosub(func-set-sipheader,s,1(Answer-Mode,Auto))exten =&gt; s,n,Gosub(func-apply-sipheaders,s,1())exten =&gt; s,n,Return()What this is doing is adding an additional SIP header to the SIP INVITE packet so that the phone will automatically answer the call. This header is the Answer-Mode header. More information about this can be found from RFC 5373Resetting the PhoneTo reset the phone you will need to know the mac address of the phone. This can be found at the back of the phone. Enter the following key combination to reset the phone:**[7][3][6][3][9][MAC][#][#]If your MAC address has letters, use the corresponding number to represent the letters. For example if you have an A in the MAC address, you will need to use the number 2. If you have a F in the MAC address, you will need to use the number 3 and so on.", "url": "/2022/01/06/avaya-1100-series-freepbx" } , "2022-01-06-secure-boot-pop-os": { "title": "How to Boot PopOS with Secure Boot", "author": "", "category": "", "content": "IntroHow to boot PopOS (or any linux distro) with secure boot enabled.Prerequisites This guide assumes that you have a working PopOS (21.10) installation and secure boot is currently disabled in the UEFI BIOS. I also assume you have some experience working through the command line in linux. These two files, obtainable here Preloader.efi Hashtool.efi Steps Open a terminal session and gain root privileges. sudo -i Change directory to /boot/efi/EFI/systemd. cd /boot/efi/EFI/systemd Verify that systemd-bootx64.efi is in this directory. $&gt; lssystemd-bootx64.efi Rename systemd-bootx64.efi to loader.efi mv systemd-bootx64.efi loader.efi Move both Preloader.efi and HashTool.efi to /boot/efi/EFI/systemd mv Preloader.efi /boot/efi/EFI/systemdmv HashTool.efi /boot/efi/EFI/systemd Rename Preloader.efi to systemd-bootx64.efi mv Preloader.efi systemd-bootx64.efi Reboot into BIOS and enable secure boot. Reboot again and you should now see this screen: Simply select OK to continue. Select Enroll Hash Select loader.efi and press enter. It will ask if you want to Enroll this hash into the MOK database?. Simply select YES. It will bring you back to the main menu. Select Enroll Hash again. Repeat steps 10 and 11 with vmlinuz.efi which can be found by selecting ../ &gt; Pop_OS-.... Once you have completed the above, reboot the system and it should successfully boot into PopOS with secure boot enabled.Notes Sometimes when updating PopOS, it will modify the .efi files. This will prevent PopOS from booting with secure boot again. To fix this simply re-enroll the hashes again (Steps 9-13) to fix the issue.", "url": "/2022/01/06/secure-boot-pop-os" } }; </script> <script src="/assets/js/lunr.min.js"></script> <script src="/assets/js/search.js"></script></main><script type="text/javascript"> function sendMessage(message) { const iframe = document.querySelector('iframe.giscus-frame'); if (!iframe) return; console.log("test"); iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app'); } function setTheme(theme) { const giscusIframe = document.querySelector('iframe.giscus-frame'); if (theme === "dark") { document.documentElement.setAttribute('data-theme', 'dark'); window.localStorage.setItem('theme', 'dark'); document.getElementById("theme-toggle").classList.add('sun'); document.getElementById("theme-toggle").classList.remove('moon'); sendMessage({ setConfig: { theme: 'dark', } }); } else { document.documentElement.setAttribute('data-theme', 'light'); window.localStorage.setItem('theme', 'light'); document.getElementById("theme-toggle").classList.add('moon'); document.getElementById("theme-toggle").classList.remove('sun'); sendMessage({ setConfig: { theme: 'light', } }); } const event = new Event('themeChanged'); document.dispatchEvent(event); } let theme = localStorage.getItem('theme'); theme = theme || (window.matchMedia ? window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light' : 'light'); setTheme(theme); function modeSwitcher() { let currentMode = document.documentElement.getAttribute('data-theme'); if (currentMode === "dark") { setTheme('light'); } else { setTheme('dark'); } } </script></body></html>
